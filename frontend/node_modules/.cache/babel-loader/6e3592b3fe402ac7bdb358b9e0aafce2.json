{"ast":null,"code":"import axios from \"axios\";\nimport VueBasicAlert from \"vue-basic-alert\";\nexport default {\n  name: \"Table\",\n\n  data() {\n    return {\n      orderObj: {\n        name: \"\",\n        phone: \"\",\n        people: \"\",\n        tables: \"\",\n        card: \"\",\n        when: \"\",\n        note: \"\"\n      },\n      errorObj: {\n        nameErr: [],\n        phoneErr: [],\n        peopleErr: [],\n        tablesErr: [],\n        cardErr: [],\n        whenErr: []\n      }\n    };\n  },\n\n  methods: {\n    availableTime: function () {\n      var now = new Date();\n      var day = (\"0\" + now.getDate()).slice(-2);\n      var currentMonth = (\"0\" + (now.getMonth() + 1)).slice(-2);\n      var maxMonth = (\"0\" + (now.getMonth() + 3)).slice(-2);\n      var hour = (\"0\" + now.getHours()).slice(-2);\n      var min = (\"0\" + now.getMinutes()).slice(-2);\n      var minRange = now.getFullYear() + \"-\" + currentMonth + \"-\" + day + \"T\" + hour + \":\" + min;\n      var maxRange = now.getFullYear() + \"-\" + maxMonth + \"-\" + day + \"T\" + hour + \":\" + min;\n      document.getElementById(\"oWhen\").setAttribute(\"min\", minRange);\n      document.getElementById(\"oWhen\").setAttribute(\"max\", maxRange);\n    },\n    resetCheckErr: function () {\n      this.errorObj.nameErr = [];\n      this.errorObj.phoneErr = [];\n      this.errorObj.peopleErr = [];\n      this.errorObj.tablesErr = [];\n      this.errorObj.cardErr = [];\n      this.errorObj.whenErr = [];\n    },\n    checkEmptyErr: function () {\n      for (var typeErr in this.errorObj) {\n        if (this.errorObj[typeErr].length != 0) {\n          return false;\n        }\n      }\n\n      return true;\n    },\n    checkForm: function () {\n      this.resetCheckErr(); // Name validate\n\n      if (!this.orderObj.name) {\n        this.errorObj.nameErr.push(\"Требуется ввести имя\");\n      } else {\n        if (!/^[А-Яа-я]+$/.test(this.orderObj.name.replace(/\\s/g, \"\"))) {\n          this.errorObj.nameErr.push(\"Имя может содержать только буквы\");\n        }\n      } // Phone validate\n\n\n      if (!this.orderObj.phone) {\n        this.errorObj.phoneErr.push(\"Ввод номера телефона обязателен\");\n      } else {\n        if (!this.orderObj.phone.startsWith(\"7\")) {\n          this.errorObj.phoneErr.push(\"Номер телефона должен начинаться с 7\");\n        }\n\n        if (!/[0-9]{10}/.test(this.orderObj.phone)) {\n          this.errorObj.phoneErr.push(\"Номера телефонов могут содержать только цифры\");\n        }\n\n        if (this.orderObj.phone.length != 11) {\n          this.errorObj.phoneErr.push(\"Phone numbers must have exactly 11 digits\");\n        }\n      }\n\n      if (!this.orderObj.people) {\n        this.errorObj.peopleErr.push(\"Entering number of people is required\");\n      } else {\n        if (parseInt(this.orderObj.people) > 100) {\n          this.errorObj.peopleErr.push(\"Each store can only serve 100 people at a time\");\n        }\n\n        if (parseInt(this.orderObj.people) < 1) {\n          this.errorObj.peopleErr.push(\"Number of people must be greater than or equal to 1\");\n        }\n      }\n\n      if (!this.orderObj.tables) {\n        this.errorObj.tablesErr.push(\"Entering number of tables is required\");\n      } else {\n        if (parseInt(this.orderObj.tables) > 50) {\n          this.errorObj.tablesErr.push(\"Each store can only have maximum 50 tables\");\n        }\n\n        if (parseInt(this.orderObj.tables) < 1) {\n          this.errorObj.tablesErr.push(\"Number of tables must be greater than or equal to 1\");\n        }\n\n        if (parseInt(this.orderObj.people) < parseInt(this.orderObj.tables)) {\n          this.errorObj.tablesErr.push(\"The number of tables must be less than the number of people\");\n        }\n      }\n\n      if (this.orderObj.card) {\n        if (!/[0-9]{10}/.test(this.orderObj.card)) {\n          this.errorObj.cardErr.push(\"Card numbers can only contain numbers\");\n        }\n\n        if (this.orderObj.card.length != 10) {\n          this.errorObj.cardErr.push(\"Card number must have exactly 10 digits\");\n        }\n      }\n\n      if (!this.orderObj.when) {\n        this.errorObj.whenErr.push(\"Entering when to serve is required\");\n      } else {\n        let minRange = document.getElementById(\"oWhen\").getAttribute(\"min\");\n        let maxRange = document.getElementById(\"oWhen\").getAttribute(\"max\");\n        let dateMin = new Date(minRange);\n        let dateMax = new Date(maxRange);\n        let dateInput = new Date(this.orderObj.when);\n\n        if (dateInput === \"Invalid Date\") {\n          this.errorObj.whenErr.push(\"Invalid date input\");\n        }\n\n        if (dateInput.getTime() < dateMin.getTime() || dateInput.getTime() > dateMax.getTime()) {\n          this.errorObj.whenErr.push(\"Available reservation range is from now to next two months\");\n        }\n\n        if (dateInput.getHours() < 7 || dateInput.getHours() > 22) {\n          this.errorObj.whenErr.push(\"Store open from 7:00 AM to 10:00 PM everyday\");\n        }\n      }\n    },\n\n    async handleSubmit(e) {\n      this.checkForm();\n\n      if (!this.checkEmptyErr()) {\n        e.preventDefault();\n      } else {\n        e.preventDefault();\n        let data = {\n          book_name: this.orderObj.name,\n          book_phone: parseInt(this.orderObj.phone),\n          book_people: parseInt(this.orderObj.people),\n          book_tables: parseInt(this.orderObj.tables),\n          user_id: parseInt(this.orderObj.card),\n          book_when: this.orderObj.when,\n          book_note: this.orderObj.note\n        };\n        await axios.post(\"/booking\", data);\n        this.$refs.alert.showAlert(\"Успешно\", \"Спасибо! Мы перезвоним вам в ближайшее время, чтобы подтвердить ваш заказ\", \"Бронирование успешно!\");\n        document.getElementById(\"bookTableForm\").reset();\n      }\n    }\n\n  },\n  components: {\n    VueBasicAlert\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","VueBasicAlert","name","data","orderObj","phone","people","tables","card","when","note","errorObj","nameErr","phoneErr","peopleErr","tablesErr","cardErr","whenErr","methods","availableTime","now","Date","day","getDate","slice","currentMonth","getMonth","maxMonth","hour","getHours","min","getMinutes","minRange","getFullYear","maxRange","document","getElementById","setAttribute","resetCheckErr","checkEmptyErr","typeErr","length","checkForm","push","test","replace","startsWith","parseInt","getAttribute","dateMin","dateMax","dateInput","getTime","handleSubmit","e","preventDefault","book_name","book_phone","book_people","book_tables","user_id","book_when","book_note","post","$refs","alert","showAlert","reset","components"],"sourceRoot":"","sources":["C:\\Users\\User\\Desktop\\restaurant-ordering-system-master\\frontend\\src\\pages\\Table.vue"],"sourcesContent":["<template>\n  <vue-basic-alert :duration=\"300\" :closeIn=\"2000\" ref=\"alert\" />\n  <section class=\"order-section\">\n    <div class=\"heading\">\n      <span>book a table</span>\n      <h3>enjoy your moment</h3>\n    </div>\n\n    <div class=\"icons-container\">\n      <div class=\"icons\">\n        <img src=\"../assets/images/icon-1.png\" alt=\"\" />\n        <h3>с 9:00 до 22:00</h3>\n      </div>\n\n      <div class=\"icons\">\n        <img src=\"../assets/images/icon-2.png\" alt=\"\" />\n        <h3>+7 963 777 7777</h3>\n      </div>\n\n      <div class=\"icons\">\n        <img src=\"../assets/images/icon-3.png\" alt=\"\" />\n        <h3>Удмуртский государственный университет</h3>\n      </div>\n    </div>\n\n    <!-- booking form -->\n    <form\n      id=\"bookTableForm\"\n      @submit=\"handleSubmit\"\n      novalidate\n      autocomplete=\"off\"\n    >\n      <div class=\"row\">\n        <div class=\"input-box\">\n          <label for=\"uName\">Ваше имя</label>\n          <input type=\"text\" name=\"uName\" id=\"uName\" v-model=\"orderObj.name\" />\n          <p v-if=\"errorObj.nameErr.length > 0\">{{ errorObj.nameErr[0] }}</p>\n        </div>\n        <div class=\"input-box\">\n          <label for=\"uPhone\">Ваш номер телефона</label>\n          <input\n            type=\"text\"\n            name=\"uPhone\"\n            id=\"uPhone\"\n            v-model=\"orderObj.phone\"\n          />\n          <p v-if=\"errorObj.phoneErr.length > 0\">{{ errorObj.phoneErr[0] }}</p>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"input-box\">\n          <label for=\"oPeople\">Сколько персон</label>\n          <input\n            type=\"number\"\n            name=\"oPeople\"\n            id=\"oPeople\"\n            v-model=\"orderObj.people\"\n          />\n          <p v-if=\"errorObj.peopleErr.length > 0\">\n            {{ errorObj.peopleErr[0] }}\n          </p>\n        </div>\n        <div class=\"input-box\">\n          <label for=\"oTables\">Сколько столов</label>\n          <input\n            type=\"number\"\n            name=\"oTables\"\n            id=\"oTables\"\n            v-model=\"orderObj.tables\"\n          />\n          <p v-if=\"errorObj.tablesErr.length > 0\">\n            {{ errorObj.tablesErr[0] }}\n          </p>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"input-box\">\n          <label for=\"uCard\">Номер карты посетителя</label>\n          <input type=\"text\" name=\"uCard\" id=\"uCard\" v-model=\"orderObj.card\" />\n          <p v-if=\"errorObj.cardErr.length > 0\">{{ errorObj.cardErr[0] }}</p>\n        </div>\n        <div class=\"input-box\">\n          <label for=\"oWhen\">Дата и Время</label>\n          <input\n            type=\"datetime-local\"\n            name=\"oWhen\"\n            id=\"oWhen\"\n            v-model=\"orderObj.when\"\n            @click=\"availableTime()\"\n          />\n          <p v-if=\"errorObj.whenErr.length > 0\">{{ errorObj.whenErr[0] }}</p>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"input-box\">\n          <label for=\"uMessage\">Комментарий</label>\n          <textarea\n            placeholder=\"Тут вы можете написать свои пожелания\"\n            name=\"uMessage\"\n            id=\"uMessage\"\n            cols=\"30\"\n            rows=\"10\"\n            v-model=\"orderObj.note\"\n          ></textarea>\n        </div>\n        <div class=\"input-box\">\n          <iframe\n            class=\"map\"\n            src=\"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3723.8938607918262!2d105.77118931493284!3d21.03693248599396!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x313454b6336e0f73%3A0x713103931378d09e!2zMiBExrDGoW5nIEtodcOqLCBNYWkgROG7i2NoLCBD4bqndSBHaeG6pXksIEjDoCBO4buZaQ!5e0!3m2!1svi!2s!4v1637511438358!5m2!1svi!2s\"\n            loading=\"lazy\"\n          ></iframe>\n        </div>\n      </div>\n\n      <input type=\"submit\" value=\"Забронировать\" class=\"btn\" />\n    </form>\n  </section>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport VueBasicAlert from \"vue-basic-alert\";\nexport default {\n  name: \"Table\",\n\n  data() {\n    return {\n      orderObj: {\n        name: \"\",\n        phone: \"\",\n        people: \"\",\n        tables: \"\",\n        card: \"\",\n        when: \"\",\n        note: \"\",\n      },\n      errorObj: {\n        nameErr: [],\n        phoneErr: [],\n        peopleErr: [],\n        tablesErr: [],\n        cardErr: [],\n        whenErr: [],\n      },\n    };\n  },\n\n  methods: {\n    availableTime: function () {\n      var now = new Date();\n      var day = (\"0\" + now.getDate()).slice(-2);\n      var currentMonth = (\"0\" + (now.getMonth() + 1)).slice(-2);\n      var maxMonth = (\"0\" + (now.getMonth() + 3)).slice(-2);\n      var hour = (\"0\" + now.getHours()).slice(-2);\n      var min = (\"0\" + now.getMinutes()).slice(-2);\n      var minRange =\n        now.getFullYear() +\n        \"-\" +\n        currentMonth +\n        \"-\" +\n        day +\n        \"T\" +\n        hour +\n        \":\" +\n        min;\n      var maxRange =\n        now.getFullYear() + \"-\" + maxMonth + \"-\" + day + \"T\" + hour + \":\" + min;\n\n      document.getElementById(\"oWhen\").setAttribute(\"min\", minRange);\n      document.getElementById(\"oWhen\").setAttribute(\"max\", maxRange);\n    },\n\n    resetCheckErr: function () {\n      this.errorObj.nameErr = [];\n      this.errorObj.phoneErr = [];\n      this.errorObj.peopleErr = [];\n      this.errorObj.tablesErr = [];\n      this.errorObj.cardErr = [];\n      this.errorObj.whenErr = [];\n    },\n\n    checkEmptyErr: function () {\n      for (var typeErr in this.errorObj) {\n        if (this.errorObj[typeErr].length != 0) {\n          return false;\n        }\n      }\n      return true;\n    },\n\n    checkForm: function () {\n      this.resetCheckErr();\n\n      // Name validate\n      if (!this.orderObj.name) {\n        this.errorObj.nameErr.push(\"Требуется ввести имя\");\n      } else {\n        if (!/^[А-Яа-я]+$/.test(this.orderObj.name.replace(/\\s/g, \"\"))) {\n          this.errorObj.nameErr.push(\"Имя может содержать только буквы\");\n        }\n      }\n\n      // Phone validate\n      if (!this.orderObj.phone) {\n        this.errorObj.phoneErr.push(\"Ввод номера телефона обязателен\");\n      } else {\n        if (!this.orderObj.phone.startsWith(\"7\")) {\n          this.errorObj.phoneErr.push(\"Номер телефона должен начинаться с 7\");\n        }\n\n        if (!/[0-9]{10}/.test(this.orderObj.phone)) {\n          this.errorObj.phoneErr.push(\"Номера телефонов могут содержать только цифры\");\n        }\n\n        if (this.orderObj.phone.length != 11) {\n          this.errorObj.phoneErr.push(\n            \"Phone numbers must have exactly 11 digits\"\n          );\n        }\n      }\n\n      if (!this.orderObj.people) {\n        this.errorObj.peopleErr.push(\"Entering number of people is required\");\n      } else {\n        if (parseInt(this.orderObj.people) > 100) {\n          this.errorObj.peopleErr.push(\n            \"Each store can only serve 100 people at a time\"\n          );\n        }\n\n        if (parseInt(this.orderObj.people) < 1) {\n          this.errorObj.peopleErr.push(\n            \"Number of people must be greater than or equal to 1\"\n          );\n        }\n      }\n\n      if (!this.orderObj.tables) {\n        this.errorObj.tablesErr.push(\"Entering number of tables is required\");\n      } else {\n        if (parseInt(this.orderObj.tables) > 50) {\n          this.errorObj.tablesErr.push(\n            \"Each store can only have maximum 50 tables\"\n          );\n        }\n\n        if (parseInt(this.orderObj.tables) < 1) {\n          this.errorObj.tablesErr.push(\n            \"Number of tables must be greater than or equal to 1\"\n          );\n        }\n\n        if (parseInt(this.orderObj.people) < parseInt(this.orderObj.tables)) {\n          this.errorObj.tablesErr.push(\n            \"The number of tables must be less than the number of people\"\n          );\n        }\n      }\n\n      if (this.orderObj.card) {\n        if (!/[0-9]{10}/.test(this.orderObj.card)) {\n          this.errorObj.cardErr.push(\"Card numbers can only contain numbers\");\n        }\n\n        if (this.orderObj.card.length != 10) {\n          this.errorObj.cardErr.push(\"Card number must have exactly 10 digits\");\n        }\n      }\n\n      if (!this.orderObj.when) {\n        this.errorObj.whenErr.push(\"Entering when to serve is required\");\n      } else {\n        let minRange = document.getElementById(\"oWhen\").getAttribute(\"min\");\n        let maxRange = document.getElementById(\"oWhen\").getAttribute(\"max\");\n        let dateMin = new Date(minRange);\n        let dateMax = new Date(maxRange);\n        let dateInput = new Date(this.orderObj.when);\n\n        if (dateInput === \"Invalid Date\") {\n          this.errorObj.whenErr.push(\"Invalid date input\");\n        }\n\n        if (\n          dateInput.getTime() < dateMin.getTime() ||\n          dateInput.getTime() > dateMax.getTime()\n        ) {\n          this.errorObj.whenErr.push(\n            \"Available reservation range is from now to next two months\"\n          );\n        }\n\n        if (dateInput.getHours() < 7 || dateInput.getHours() > 22) {\n          this.errorObj.whenErr.push(\n            \"Store open from 7:00 AM to 10:00 PM everyday\"\n          );\n        }\n      }\n    },\n\n    async handleSubmit(e) {\n      this.checkForm();\n\n      if (!this.checkEmptyErr()) {\n        e.preventDefault();\n      } else {\n        e.preventDefault();\n\n        let data = {\n          book_name: this.orderObj.name,\n          book_phone: parseInt(this.orderObj.phone),\n          book_people: parseInt(this.orderObj.people),\n          book_tables: parseInt(this.orderObj.tables),\n          user_id: parseInt(this.orderObj.card),\n          book_when: this.orderObj.when,\n          book_note: this.orderObj.note,\n        };\n\n        await axios.post(\"/booking\", data);\n\n        this.$refs.alert.showAlert(\n          \"Успешно\",\n          \"Спасибо! Мы перезвоним вам в ближайшее время, чтобы подтвердить ваш заказ\",\n          \"Бронирование успешно!\"\n        );\n        document.getElementById(\"bookTableForm\").reset();\n      }\n    },\n  },\n\n  components: {\n    VueBasicAlert,\n  },\n};\n</script>\n\n<style scoped>\n.order-section {\n  padding: 2rem 9%;\n}\n\n.order-section .icons-container {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(40rem, 1fr));\n  gap: 1.5rem;\n  margin-bottom: 2rem;\n}\n\n.order-section .icons-container .icons {\n  border-radius: 0.5rem;\n  padding: 2rem;\n  text-align: center;\n  background: #f7f7f7;\n}\n\n.order-section .icons-container .icons img {\n  height: 10rem;\n}\n\n.order-section .icons-container .icons h3 {\n  font-size: 2rem;\n  color: #130f40;\n  margin-top: 0.5rem;\n}\n\n.order-section form {\n  background: #f7f7f7;\n  padding: 2rem;\n  border-radius: 0.5rem;\n}\n\n.order-section form .row {\n  justify-content: space-between;\n}\n\n.order-section form .row .input-box {\n  width: 49%;\n  padding: 1.8rem 0;\n}\n\n.order-section form .row label {\n  font-size: 1.7rem;\n  color: #666;\n}\n\n.order-section form .row p {\n  font-size: 1.5rem;\n  position: absolute;\n  color: rgb(243, 47, 47);\n  margin: 0;\n  padding-top: 5px;\n}\n\n.order-section form .row input,\n.order-section form .row textarea {\n  width: 100%;\n  margin-top: 0.5rem;\n  padding: 1rem 1.2rem;\n  width: 100%;\n  border-radius: 0.5rem;\n  font-size: 1.6rem;\n  text-transform: none;\n  color: #130f40;\n}\n\n.order-section form .row textarea {\n  height: 20rem;\n  resize: none;\n}\n\n.order-section form .row .map {\n  height: 100%;\n  width: 100%;\n  border-radius: 0.5rem;\n}\n\n@media (max-width: 768px) {\n  .order form .row .input-box {\n    width: 100%;\n  }\n\n  .order-section form .row {\n    display: block;\n    max-width: 100%;\n    width: 100%;\n    margin: 0;\n  }\n\n  .order-section form .row .input-box {\n    width: 100%;\n  }\n}\n\n@media (max-width: 576px) {\n  .order-section .icons-container {\n    grid-template-columns: repeat(auto-fit, minmax(30rem, 1fr));\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}