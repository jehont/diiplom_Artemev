{"ast":null,"code":"import axios from \"axios\";\nimport { mapState, mapMutations } from \"vuex\";\nexport default {\n  name: \"Dashboard\",\n\n  data() {\n    return {\n      avaiableStatus: [\"Отменен\", \"Подтвержден\", \"Готовится\", \"Проверяется\", \"Едет к вам\", \"Доставлено\", \"Завершен\"],\n      allBills: [],\n      showOrderDetails: false,\n      sendId: undefined,\n      interval: \"\"\n    };\n  },\n\n  created() {\n    this.getAllBills();\n\n    if (!this.admin) {\n      this.$router.push(\"/\");\n    }\n  },\n\n  mounted: function () {\n    this.autoUpdate();\n  },\n\n  beforeUnmount() {\n    clearInterval(this.interval);\n  },\n\n  computed: { ...mapState([\"allFoods\", \"admin\"]),\n    filterBills: function () {\n      return this.allBills.filter(b => b.bill_status < 6 && b.bill_status > 0);\n    }\n  },\n  methods: { ...mapMutations([\"setAdmin\"]),\n\n    async getAllBills() {\n      this.allBills = (await axios.get(\"/billstatus\")).data;\n    },\n\n    sendBillId: function (id) {\n      this.sendId = id;\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n    sendBilluserId: function (user_id) {\n      this.sendId = user_id;\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n    closeView: function () {\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n    handleLogout: function () {\n      this.setAdmin(\"\");\n    },\n\n    async nextStatusBtn(id) {\n      await axios.put(\"/billstatus/\" + id);\n      this.getAllBills();\n    },\n\n    async paidBtn(id) {\n      await axios.put(\"/billstatus/paid/\" + id);\n      this.getAllBills();\n    },\n\n    async cancelBtn(id) {\n      await axios.put(\"/billstatus/cancel/\" + id);\n      this.getAllBills();\n    },\n\n    autoUpdate: function () {\n      this.interval = setInterval(function () {\n        this.getAllBills();\n      }.bind(this), 1000);\n    }\n  }\n};","map":{"version":3,"mappings":"AA4EA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,EAAmBC,YAAnB,QAAuC,MAAvC;AACA,eAAe;EACbC,IAAI,EAAE,WADO;;EAGbC,IAAI,GAAG;IACL,OAAO;MACLC,cAAc,EAAE,CACd,SADc,EAEd,aAFc,EAGd,WAHc,EAId,aAJc,EAKd,YALc,EAMd,YANc,EAOd,UAPc,CADX;MAULC,QAAQ,EAAE,EAVL;MAWLC,gBAAgB,EAAE,KAXb;MAYLC,MAAM,EAAEC,SAZH;MAaLC,QAAQ,EAAE;IAbL,CAAP;EAeD,CAnBY;;EAqBbC,OAAO,GAAG;IACR,KAAKC,WAAL;;IACA,IAAI,CAAC,KAAKC,KAAV,EAAiB;MACf,KAAKC,OAAL,CAAaC,IAAb,CAAkB,GAAlB;IACF;EACD,CA1BY;;EA4BbC,OAAO,EAAE,YAAY;IACnB,KAAKC,UAAL;EACD,CA9BY;;EAgCbC,aAAa,GAAG;IACdC,aAAa,CAAC,KAAKT,QAAN,CAAb;EACD,CAlCY;;EAoCbU,QAAQ,EAAE,EACR,GAAGnB,QAAQ,CAAC,CAAC,UAAD,EAAa,OAAb,CAAD,CADH;IAGRoB,WAAW,EAAE,YAAY;MACvB,OAAO,KAAKf,QAAL,CAAcgB,MAAd,CACJC,CAAD,IAAOA,CAAC,CAACC,WAAF,GAAgB,CAAhB,IAAqBD,CAAC,CAACC,WAAF,GAAgB,CADvC,CAAP;IAGD;EAPO,CApCG;EA8CbC,OAAO,EAAE,EACP,GAAGvB,YAAY,CAAC,CAAC,UAAD,CAAD,CADR;;IAGP,MAAMU,WAAN,GAAoB;MAClB,KAAKN,QAAL,GAAgB,CAAC,MAAMN,KAAK,CAAC0B,GAAN,CAAU,aAAV,CAAP,EAAiCtB,IAAjD;IACD,CALM;;IAQPuB,UAAU,EAAE,UAAUC,EAAV,EAAc;MACxB,KAAKpB,MAAL,GAAcoB,EAAd;MACA,KAAKrB,gBAAL,GAAwB,CAAC,KAAKA,gBAA9B;IACD,CAXM;IAaPsB,cAAc,EAAE,UAAUC,OAAV,EAAmB;MACjC,KAAKtB,MAAL,GAAcsB,OAAd;MACA,KAAKvB,gBAAL,GAAwB,CAAC,KAAKA,gBAA9B;IACD,CAhBM;IAkBPwB,SAAS,EAAE,YAAY;MACrB,KAAKxB,gBAAL,GAAwB,CAAC,KAAKA,gBAA9B;IACD,CApBM;IAsBPyB,YAAY,EAAE,YAAY;MACxB,KAAKC,QAAL,CAAc,EAAd;IACD,CAxBM;;IA0BP,MAAMC,aAAN,CAAoBN,EAApB,EAAwB;MACtB,MAAM5B,KAAK,CAACmC,GAAN,CAAU,iBAAiBP,EAA3B,CAAN;MACA,KAAKhB,WAAL;IACD,CA7BM;;IA+BP,MAAMwB,OAAN,CAAcR,EAAd,EAAkB;MAChB,MAAM5B,KAAK,CAACmC,GAAN,CAAU,sBAAsBP,EAAhC,CAAN;MACA,KAAKhB,WAAL;IACD,CAlCM;;IAoCP,MAAMyB,SAAN,CAAgBT,EAAhB,EAAoB;MAClB,MAAM5B,KAAK,CAACmC,GAAN,CAAU,wBAAwBP,EAAlC,CAAN;MACA,KAAKhB,WAAL;IACD,CAvCM;;IAyCPK,UAAU,EAAE,YAAY;MACtB,KAAKP,QAAL,GAAgB4B,WAAW,CACzB,YAAY;QACV,KAAK1B,WAAL;MACD,CAFD,CAEE2B,IAFF,CAEO,IAFP,CADyB,EAIzB,IAJyB,CAA3B;IAMD;EAhDM;AA9CI,CAAf","names":["axios","mapState","mapMutations","name","data","avaiableStatus","allBills","showOrderDetails","sendId","undefined","interval","created","getAllBills","admin","$router","push","mounted","autoUpdate","beforeUnmount","clearInterval","computed","filterBills","filter","b","bill_status","methods","get","sendBillId","id","sendBilluserId","user_id","closeView","handleLogout","setAdmin","nextStatusBtn","put","paidBtn","cancelBtn","setInterval","bind"],"sourceRoot":"","sources":["C:\\Users\\User\\Desktop\\restaurant-ordering-system-master\\frontend\\src\\admin\\Dashboard.vue"],"sourcesContent":["<template>\n  <div class=\"admin-container\">\n    <div class=\"d-flex justify-content-between\">\n      <h1>Приветствую администратора</h1>\n      <button class=\"btn\" @click=\"handleLogout()\">Выйти</button>\n    </div>\n\n    <div class=\"table-responsive\">\n      <!-- PROJECT TABLE -->\n      <table class=\"table colored-header datatable project-list\">\n        <thead>\n          <tr>\n            <th>Идентификатор счета</th>\n            <th>Номер пользователя </th>\n            <th>Телефон</th>\n            <th>Адрес</th>\n            <th>Время заказа</th>\n            <th>Оплата</th>\n            <th>Сумма</th>\n            <th>Статус</th>\n            <th>Действие</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"b in filterBills.slice().reverse()\" :key=\"b.bill_id\">\n            <td>{{ b.bill_id }}</td>\n            <td>{{ b.user_id }}</td>\n            <td>{{ b.bill_phone }}</td>\n            <td>{{ b.bill_address }}</td>\n            <td>{{ b.bill_when }}</td>\n            <td>{{b.bill_paid }}</td>\n            <td>₽{{ b.bill_total }}</td>\n            <td>{{ avaiableStatus[b.bill_status] }}</td>\n            <td>\n              <button\n                v-if=\"b.bill_status < 5\"\n                class=\"action-btn\"\n                @click=\"nextStatusBtn(b.bill_id)\"\n              >\n                {{ avaiableStatus[b.bill_status + 1] }}\n              </button>\n\n              <button\n                v-if=\"b.bill_status == 1\"\n                class=\"cancel-btn\"\n                @click=\"cancelBtn(b.bill_id)\"\n              >\n                Отмена\n              </button>\n\n              <button\n                v-else-if=\"b.bill_status == 5 && b.bill_paid == 'false'\"\n                class=\"paid-btn\"\n                @click=\"paidBtn(b.bill_id)\"\n              >\n                оплачено\n              </button>\n\n              \n              <button\n                v-else-if=\"b.bill_status == 5 && b.bill_paid == 'true'\"\n                class=\"action-btn\"\n                @click=\"nextStatusBtn(b.bill_id)\"\n              >\n                {{ avaiableStatus[b.bill_status + 1] }}\n              </button>\n\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport { mapState, mapMutations } from \"vuex\";\nexport default {\n  name: \"Dashboard\",\n\n  data() {\n    return {\n      avaiableStatus: [\n        \"Отменен\",\n        \"Подтвержден\",\n        \"Готовится\",\n        \"Проверяется\",\n        \"Едет к вам\",\n        \"Доставлено\",\n        \"Завершен\",\n      ],\n      allBills: [],\n      showOrderDetails: false,\n      sendId: undefined,\n      interval: \"\",\n    };\n  },\n\n  created() {\n    this.getAllBills();\n    if (!this.admin) {\n      this.$router.push(\"/\");\n    }\n  },\n\n  mounted: function () {\n    this.autoUpdate();\n  },\n\n  beforeUnmount() {\n    clearInterval(this.interval);\n  },\n\n  computed: {\n    ...mapState([\"allFoods\", \"admin\"]),\n\n    filterBills: function () {\n      return this.allBills.filter(\n        (b) => b.bill_status < 6 && b.bill_status > 0\n      );\n    },\n  },\n\n  methods: {\n    ...mapMutations([\"setAdmin\"]),\n\n    async getAllBills() {\n      this.allBills = (await axios.get(\"/billstatus\")).data;\n    },\n    \n\n    sendBillId: function (id) {\n      this.sendId = id;\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n\n    sendBilluserId: function (user_id) {\n      this.sendId = user_id;\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n\n    closeView: function () {\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n\n    handleLogout: function () {\n      this.setAdmin(\"\");\n    },\n\n    async nextStatusBtn(id) {\n      await axios.put(\"/billstatus/\" + id);\n      this.getAllBills();\n    },\n\n    async paidBtn(id) {\n      await axios.put(\"/billstatus/paid/\" + id);\n      this.getAllBills();\n    },\n\n    async cancelBtn(id) {\n      await axios.put(\"/billstatus/cancel/\" + id);\n      this.getAllBills();\n    },\n\n    autoUpdate: function () {\n      this.interval = setInterval(\n        function () {\n          this.getAllBills();\n        }.bind(this),\n        1000\n      );\n    },\n  },\n};\n</script>\n\n<style scoped>\n.admin-container {\n  background-color: #fff;\n  height: 100vh;\n  padding: 2rem 9%;\n  font-size: 16px;\n}\n\n.project-list > tbody > tr > td {\n  padding: 12px 8px;\n}\n\n.project-list > tbody > tr > td .avatar {\n  width: 22px;\n  border: 1px solid #ccc;\n}\n\n.table-responsive {\n  margin-top: 8vh;\n}\n\n.action-btn,\n.cancel-btn,\n.paid-btn {\n  width: 100px;\n  height: 25px;\n  color: white;\n}\n\n.action-btn {\n  background-color: #0da9ef;\n  margin-right: 10px;\n}\n\n.cancel-btn,\n.paid-btn {\n  background-color: red;\n}\n\n.action-btn:hover {\n  background-color: #27ae60;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}