{"ast":null,"code":"import OrderDetails from \"@/components/OrderDetails.vue\";\nimport axios from \"axios\";\nimport { mapState, mapMutations } from \"vuex\";\nexport default {\n  name: \"Dashboard\",\n\n  data() {\n    return {\n      avaiableStatus: [\"Отменен\", \"Подтвержден\", \"Готовится\", \"Проверяется\", \"Едет к вам\", \"Доставлено\", \"Завершен\"],\n      allBills: [],\n      allTableBookings: [],\n      showOrderDetails: false,\n      sendId: undefined,\n      interval: \"\"\n    };\n  },\n\n  created() {\n    this.getAllBills();\n    this.getAllTableBookings();\n\n    if (!this.admin) {\n      this.$router.push(\"/\");\n    }\n  },\n\n  mounted: function () {\n    this.autoUpdate();\n  },\n\n  beforeUnmount() {\n    clearInterval(this.interval);\n  },\n\n  computed: { ...mapState([\"allFoods\", \"admin\"]),\n    filterBills: function () {\n      return this.allBills.filter(b => b.bill_status < 6 && b.bill_status > 0);\n    },\n    filterTables: function () {\n      return this.allTableBookings.filter(t => 1 > 0);\n    }\n  },\n  methods: { ...mapMutations([\"setAdmin\"]),\n\n    async getAllBills() {\n      this.allBills = (await axios.get(\"/billstatus\")).data;\n    },\n\n    async getAllTableBookings() {\n      this.allTableBookings = (await axios.get(\"/booktable\")).data;\n    },\n\n    sendBillId: function (id) {\n      this.sendId = id;\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n    sendBilluserId: function (user_id) {\n      this.sendId = user_id;\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n    closeView: function () {\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n    handleLogout: function () {\n      this.setAdmin(\"\");\n    },\n\n    async nextStatusBtn(id) {\n      await axios.put(\"/billstatus/\" + id);\n      this.getAllBills();\n    },\n\n    async paidBtn(id) {\n      await axios.put(\"/billstatus/paid/\" + id);\n      this.getAllBills();\n    },\n\n    async cancelBtn(id) {\n      await axios.put(\"/billstatus/cancel/\" + id);\n      this.getAllBills();\n    },\n\n    autoUpdate: function () {\n      this.interval = setInterval(function () {\n        this.getAllBills();\n        this.getAllTableBookings();\n      }.bind(this), 1000);\n    }\n  },\n  components: {\n    OrderDetails\n  }\n};","map":{"version":3,"mappings":"AAiGA,OAAOA,YAAP,MAAyB,+BAAzB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,EAAmBC,YAAnB,QAAuC,MAAvC;AACA,eAAe;EACbC,IAAI,EAAE,WADO;;EAGbC,IAAI,GAAG;IACL,OAAO;MACLC,cAAc,EAAE,CACd,SADc,EAEd,aAFc,EAGd,WAHc,EAId,aAJc,EAKd,YALc,EAMd,YANc,EAOd,UAPc,CADX;MAULC,QAAQ,EAAE,EAVL;MAWLC,gBAAgB,EAAE,EAXb;MAYLC,gBAAgB,EAAE,KAZb;MAaLC,MAAM,EAAEC,SAbH;MAcLC,QAAQ,EAAE;IAdL,CAAP;EAgBD,CApBY;;EAsBbC,OAAO,GAAG;IACR,KAAKC,WAAL;IACA,KAAKC,mBAAL;;IACA,IAAI,CAAC,KAAKC,KAAV,EAAiB;MACf,KAAKC,OAAL,CAAaC,IAAb,CAAkB,GAAlB;IACF;EACD,CA5BY;;EA8BbC,OAAO,EAAE,YAAY;IACnB,KAAKC,UAAL;EACD,CAhCY;;EAkCbC,aAAa,GAAG;IACdC,aAAa,CAAC,KAAKV,QAAN,CAAb;EACD,CApCY;;EAsCbW,QAAQ,EAAE,EACR,GAAGrB,QAAQ,CAAC,CAAC,UAAD,EAAa,OAAb,CAAD,CADH;IAGRsB,WAAW,EAAE,YAAY;MACvB,OAAO,KAAKjB,QAAL,CAAckB,MAAd,CACJC,CAAD,IAAOA,CAAC,CAACC,WAAF,GAAgB,CAAhB,IAAqBD,CAAC,CAACC,WAAF,GAAgB,CADvC,CAAP;IAGD,CAPO;IASRC,YAAY,EAAE,YAAY;MACxB,OAAO,KAAKpB,gBAAL,CAAsBiB,MAAtB,CACJI,CAAD,IAAO,IAAI,CADN,CAAP;IAGD;EAbO,CAtCG;EAuDbC,OAAO,EAAE,EACP,GAAG3B,YAAY,CAAC,CAAC,UAAD,CAAD,CADR;;IAGP,MAAMW,WAAN,GAAoB;MAClB,KAAKP,QAAL,GAAgB,CAAC,MAAMN,KAAK,CAAC8B,GAAN,CAAU,aAAV,CAAP,EAAiC1B,IAAjD;IACD,CALM;;IAOP,MAAMU,mBAAN,GAA4B;MAC1B,KAAKP,gBAAL,GAAwB,CAAC,MAAMP,KAAK,CAAC8B,GAAN,CAAU,YAAV,CAAP,EAAgC1B,IAAxD;IACD,CATM;;IAYP2B,UAAU,EAAE,UAAUC,EAAV,EAAc;MACxB,KAAKvB,MAAL,GAAcuB,EAAd;MACA,KAAKxB,gBAAL,GAAwB,CAAC,KAAKA,gBAA9B;IACD,CAfM;IAiBPyB,cAAc,EAAE,UAAUC,OAAV,EAAmB;MACjC,KAAKzB,MAAL,GAAcyB,OAAd;MACA,KAAK1B,gBAAL,GAAwB,CAAC,KAAKA,gBAA9B;IACD,CApBM;IAsBP2B,SAAS,EAAE,YAAY;MACrB,KAAK3B,gBAAL,GAAwB,CAAC,KAAKA,gBAA9B;IACD,CAxBM;IA0BP4B,YAAY,EAAE,YAAY;MACxB,KAAKC,QAAL,CAAc,EAAd;IACD,CA5BM;;IA8BP,MAAMC,aAAN,CAAoBN,EAApB,EAAwB;MACtB,MAAMhC,KAAK,CAACuC,GAAN,CAAU,iBAAiBP,EAA3B,CAAN;MACA,KAAKnB,WAAL;IACD,CAjCM;;IAmCP,MAAM2B,OAAN,CAAcR,EAAd,EAAkB;MAChB,MAAMhC,KAAK,CAACuC,GAAN,CAAU,sBAAsBP,EAAhC,CAAN;MACA,KAAKnB,WAAL;IACD,CAtCM;;IAwCP,MAAM4B,SAAN,CAAgBT,EAAhB,EAAoB;MAClB,MAAMhC,KAAK,CAACuC,GAAN,CAAU,wBAAwBP,EAAlC,CAAN;MACA,KAAKnB,WAAL;IACD,CA3CM;;IA6CPM,UAAU,EAAE,YAAY;MACtB,KAAKR,QAAL,GAAgB+B,WAAW,CACzB,YAAY;QACV,KAAK7B,WAAL;QACA,KAAKC,mBAAL;MACD,CAHD,CAGE6B,IAHF,CAGO,IAHP,CADyB,EAKzB,IALyB,CAA3B;IAOD;EArDM,CAvDI;EA8GbC,UAAU,EAAE;IAAE7C;EAAF;AA9GC,CAAf","names":["OrderDetails","axios","mapState","mapMutations","name","data","avaiableStatus","allBills","allTableBookings","showOrderDetails","sendId","undefined","interval","created","getAllBills","getAllTableBookings","admin","$router","push","mounted","autoUpdate","beforeUnmount","clearInterval","computed","filterBills","filter","b","bill_status","filterTables","t","methods","get","sendBillId","id","sendBilluserId","user_id","closeView","handleLogout","setAdmin","nextStatusBtn","put","paidBtn","cancelBtn","setInterval","bind","components"],"sourceRoot":"","sources":["C:\\Users\\User\\Desktop\\restaurant-ordering-system-master\\frontend\\src\\admin\\Dashboard.vue"],"sourcesContent":["<template>\n  <div class=\"admin-container\">\n    <div class=\"d-flex justify-content-between\">\n      <h1>Приветствую администратора</h1>\n      <button class=\"btn\" @click=\"handleLogout()\">Выйти</button>\n    </div>\n\n    <div class=\"table-responsive\">\n      <!-- PROJECT TABLE -->\n      <table class=\"table colored-header datatable project-list\">\n        <thead>\n          <tr>\n            <th>Идентификатор счета</th>\n            <th>Номер пользователя </th>\n            <th>Телефон</th>\n            <th>Адрес</th>\n            <th>Время заказа</th>\n            <th>Оплата</th>\n            <th>Сумма</th>\n            <th>Статус</th>\n            <th>Действие</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"b in filterBills.slice().reverse()\" :key=\"b.bill_id\">\n            <td>{{ b.bill_id }}</td>\n            <td>{{ b.user_id }}</td>\n            <td>{{ b.bill_phone }}</td>\n            <td>{{ b.bill_address }}</td>\n            <td>{{ b.bill_when }}</td>\n            <td>{{ b.bill_paid }}</td>\n            <td>₽{{ b.bill_total }}</td>\n            <td>{{ avaiableStatus[b.bill_status] }}</td>\n            <td>\n              <button v-if=\"b.bill_status < 5\" class=\"action-btn\" @click=\"nextStatusBtn(b.bill_id)\">\n                {{ avaiableStatus[b.bill_status + 1] }}\n              </button>\n\n              <button v-if=\"b.bill_status == 1\" class=\"cancel-btn\" @click=\"cancelBtn(b.bill_id)\">\n                Отмена\n              </button>\n\n              <button v-else-if=\"b.bill_status == 5 && b.bill_paid == 'false'\" class=\"paid-btn\"\n                @click=\"paidBtn(b.bill_id)\">\n                оплачено\n              </button>\n\n\n              <button v-else-if=\"b.bill_status == 5 && b.bill_paid == 'true'\" class=\"action-btn\"\n                @click=\"nextStatusBtn(b.bill_id)\">\n                {{ avaiableStatus[b.bill_status + 1] }}\n              </button>\n\n              <button class=\"details-btn\" @click=\"sendBillId(b.bill_id)\">Детали заказа</button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n    <div>\n      <OrderDetails v-if=\"showOrderDetails\" :bill=\"sendId\">\n        <button class=\"btn\" @click=\"closeView\">X</button>\n      </OrderDetails>\n    </div>\n    <div class=\"table-responsive\">\n      <!-- PROJECT TABLE -->\n      <table class=\"table colored-header datatable project-list\">\n        <thead>\n          <tr>\n            <th>Индификатор заказа</th>\n            <th>Имя пользователя</th>\n            <th>Телефон пользователя</th>\n            <th>Количество человек</th>\n            <th>Количество столов</th>\n            <th>Номер пользователя</th>\n            <th>Дата</th>\n            <th>Записка</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"t in filterTables.slice().reverse()\" :key=\"t.book_id\">\n            <td>{{ t.book_id }}</td>\n            <td>{{ t.book_name }}</td>\n            <td>{{ t.book_phone }}</td>\n            <td>{{ t.book_people }}</td>\n            <td>{{ t.book_tables }}</td>\n            <td>{{ t.user_id }}</td>\n            <td>{{ t.book_when }}</td>\n            <td>{{ t.book_note }}</td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</template>\n\n<script>\nimport OrderDetails from \"@/components/OrderDetails.vue\";\nimport axios from \"axios\";\nimport { mapState, mapMutations } from \"vuex\";\nexport default {\n  name: \"Dashboard\",\n\n  data() {\n    return {\n      avaiableStatus: [\n        \"Отменен\",\n        \"Подтвержден\",\n        \"Готовится\",\n        \"Проверяется\",\n        \"Едет к вам\",\n        \"Доставлено\",\n        \"Завершен\",\n      ],\n      allBills: [],\n      allTableBookings: [],\n      showOrderDetails: false,\n      sendId: undefined,\n      interval: \"\",\n    };\n  },\n\n  created() {\n    this.getAllBills();\n    this.getAllTableBookings();\n    if (!this.admin) {\n      this.$router.push(\"/\");\n    }\n  },\n\n  mounted: function () {\n    this.autoUpdate();\n  },\n\n  beforeUnmount() {\n    clearInterval(this.interval);\n  },\n\n  computed: {\n    ...mapState([\"allFoods\", \"admin\"]),\n\n    filterBills: function () {\n      return this.allBills.filter(\n        (b) => b.bill_status < 6 && b.bill_status > 0\n      );\n    },\n\n    filterTables: function () {\n      return this.allTableBookings.filter(\n        (t) => 1 > 0\n      );\n    },\n\n  },\n\n  methods: {\n    ...mapMutations([\"setAdmin\"]),\n\n    async getAllBills() {\n      this.allBills = (await axios.get(\"/billstatus\")).data;\n    },\n\n    async getAllTableBookings() {\n      this.allTableBookings = (await axios.get(\"/booktable\")).data;\n    },\n\n\n    sendBillId: function (id) {\n      this.sendId = id;\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n\n    sendBilluserId: function (user_id) {\n      this.sendId = user_id;\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n\n    closeView: function () {\n      this.showOrderDetails = !this.showOrderDetails;\n    },\n\n    handleLogout: function () {\n      this.setAdmin(\"\");\n    },\n\n    async nextStatusBtn(id) {\n      await axios.put(\"/billstatus/\" + id);\n      this.getAllBills();\n    },\n\n    async paidBtn(id) {\n      await axios.put(\"/billstatus/paid/\" + id);\n      this.getAllBills();\n    },\n\n    async cancelBtn(id) {\n      await axios.put(\"/billstatus/cancel/\" + id);\n      this.getAllBills();\n    },\n\n    autoUpdate: function () {\n      this.interval = setInterval(\n        function () {\n          this.getAllBills();\n          this.getAllTableBookings();\n        }.bind(this),\n        1000\n      );\n    },\n  },\n  components: { OrderDetails }\n};\n</script>\n\n<style scoped>\n.admin-container {\n  background-color: #fff;\n  height: 100vh;\n  padding: 2rem 9%;\n  font-size: 16px;\n}\n\n.project-list>tbody>tr>td {\n  padding: 12px 8px;\n}\n\n.project-list>tbody>tr>td .avatar {\n  width: 22px;\n  border: 1px solid #ccc;\n}\n\n.table-responsive {\n  margin-top: 8vh;\n}\n\n.action-btn,\n.cancel-btn,\n.paid-btn {\n  width: 100px;\n  height: 25px;\n  color: white;\n}\n\n.action-btn {\n  background-color: #0da9ef;\n  margin-right: 10px;\n}\n\n.cancel-btn,\n.paid-btn {\n  background-color: red;\n}\n\n.action-btn:hover {\n  background-color: #27ae60;\n}\n\n.details-btn {\n  background-color: #0db60d;\n  margin-left: 10px;\n  padding: 2px;\n}\n</style>\n\n"]},"metadata":{},"sourceType":"module"}